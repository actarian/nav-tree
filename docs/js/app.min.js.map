{"version":3,"sources":["docs/js/app.js"],"names":["angular","module","config","$httpProvider","$locationProvider","html5Mode","hashPrefix","run","$rootScope","app","controller","$scope","$http","$timeout","onMenuTapped","item","level","console","log","get","then","response","items","data","error","directive","$parse","restrict","templateUrl","scope","link","element","attributes","model","parse","$parent","$level","forEach","$callback","callback","years","key","String","to","from","url","action","menu","$watch","itemOpen","immediate","state","$state","active","closed","closing","opening","opened","itemClose","o","itemToggle","onTap","e","onTouchStart","navItem","off","onMouseDown","prevent","preventDefault","removeListeners","querySelector","on","$on"],"mappings":"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","file":"app.min.js","sourcesContent":["/* global angular */\n\n(function() {\n    \"use strict\";\n\n    var app = angular.module('app', ['ngRoute', 'jsonFormatter']);\n\n}());\n/* global angular */\n\n(function() {\n    \"use strict\";\n\n    var app = angular.module('app');\n\n    app.config(['$httpProvider', function($httpProvider) {\n        // $httpProvider.defaults.withCredentials = true;\n    }]);\n\n}());\n/* global angular */\n\n(function() {\n    \"use strict\";\n\n    var app = angular.module('app');\n\n    app.config(['$locationProvider', function($locationProvider) {\n\n        // HTML5 MODE url writing method (false: #/anchor/use, true: /html5/url/use)\n        $locationProvider.html5Mode(true);\n        $locationProvider.hashPrefix('');\n\n    }]);\n\n}());\n/* global angular */\n\n(function() {\n    \"use strict\";\n\n    var app = angular.module('app');\n\n    app.run(['$rootScope', function($rootScope) {\n\n    }]);\n\n}());\n/* global angular */\n\n(function() {\n    \"use strict\";\n\n    var app = angular.module('app');\n\n    app.controller('RootCtrl', ['$scope', '$http', '$timeout', function($scope, $http, $timeout) {\n\n        $http.get('https://supahfunk.github.io/rossini/json/menu-rossini.js').then(function(response) {\n            $scope.items = response.data;\n        }, function(error) {\n            console.log('RootCtrl.error', error);\n        });\n\n        function onMenuTapped(item, level) {\n            console.log('RootCtrl.onMenuTapped', item, level);\n        }\n\n        $scope.onMenuTapped = onMenuTapped;\n\n    }]);\n\n    app.directive('tree', ['$parse', function($parse) {\n        return {\n            restrict: 'A',\n            templateUrl: 'partials/tree',\n            scope: {\n                items: '=tree',\n            },\n            link: function(scope, element, attributes, model) {\n                var callback = $parse(attributes.action)(scope.$parent);\n                console.log('callback', attributes.action, callback);\n\n                var menu = {\n                    items: [],\n                }\n\n                function parse(items, $parent, $level) {\n                    $level = $level || 0;\n                    if (items) {\n                        angular.forEach(items, function(item) {\n                            item.$parent = $parent;\n                            item.$callback = callback;\n                            item.$level = $level;\n                            if (item.years) {\n                                item.years.key = String(item.years.to ? item.years.from + '-' + item.years.to : item.years.from); // da riattivare !!!\n                                item.url = '/years/' + item.years.key;\n                                // item.detailUrl = item.url + '/detail';\n                            }\n                            parse(item.items, item, $level + 1);\n                        });\n                    }\n                }\n\n                scope.$watch('items', function(items) {\n                    if (items) {\n                        menu.items = items;\n                        parse(menu.items, menu);\n                    }\n                });\n\n                scope.item = menu;\n\n            }\n        };\n    }]);\n\n    app.directive('treeItem', ['$timeout', function($timeout) {\n        return {\n            restrict: 'A',\n            templateUrl: 'partials/tree/item',\n            scope: {\n                item: '=treeItem',\n            },\n            link: function(scope, element, attributes, model) {\n                var navItem = angular.element(element[0].querySelector('.nav-item'));\n                var state = {};\n                scope.item.$state = state;\n\n                function itemOpen(item, immediate) {\n                    var state = item.$state;\n                    state.active = true;\n\n                    $timeout(function() {\n                        state.immediate = immediate;\n                        state.closed = state.closing = false;\n                        state.opening = true;\n                        $timeout(function() {\n                            state.opening = false;\n                            state.opened = true;\n                        });\n                    });\n                }\n\n                function itemClose(item, immediate) {\n                    var state = item.$state;\n                    state.active = false;\n                    $timeout(function() {\n                        state.immediate = immediate;\n                        state.opened = state.opening = false;\n                        state.closing = true;\n                        $timeout(function() {\n                            state.closing = false;\n                            state.closed = true;\n                        });\n                    });\n                    if (item.items) {\n                        angular.forEach(item.items, function(o) {\n                            itemClose(o, true);\n                        });\n                    }\n                }\n\n                function itemToggle(item) {\n                    var state = item.$state;\n                    state.active = !state.active;\n                    if (state.active) {\n                        if (item.$parent) {\n                            angular.forEach(item.$parent.items, function(o) {\n                                if (o !== item) {\n                                    itemClose(o, true);\n                                }\n                            });\n                        }\n                        itemOpen(item);\n                    } else {\n                        itemClose(item);\n                    }\n                    // console.log(state);\n                }\n\n                function onTap(e) {\n                    // console.log('treeItem.onTap');        \n                    $timeout(function() {\n                        var item = scope.item;\n                        if (item.$callback) {\n                            item.$callback(item, item.$level);\n                        }\n                        itemToggle(item);\n                    });\n                }\n\n                function onTouchStart(e) {\n                    onTap();\n                    navItem\n                        .off('mousedown', onMouseDown);\n                    return prevent(e);\n                }\n\n                function onMouseDown(e) {\n                    onTap();\n                    navItem\n                        .off('touchstart', onTouchStart);\n                    return prevent(e);\n                }\n\n                function prevent(e) {\n                    e.preventDefault();\n                    return false;\n                }\n\n                function addListeners() {\n                    navItem\n                        .on('touchstart', onTouchStart)\n                        .on('mousedown', onMouseDown);\n                }\n\n                function removeListeners() {\n                    navItem\n                        .off('touchstart', onTouchStart)\n                        .off('mousedown', onMouseDown);\n                }\n\n                addListeners();\n\n                scope.$on('$destroy', function() {\n                    removeListeners();\n                });\n\n            }\n        };\n    }]);\n\n}());"]}